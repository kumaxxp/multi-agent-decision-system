# GUI新機能 - 詳細表示とHTML報告書

## 🆕 追加された機能

### 💬 **会話詳細表示機能**

議論の全会話内容を美しく表示する機能を追加しました。

#### 📋 表示内容
- **セッション基本情報**: トピック、実施日時、参加エージェント数など
- **背景情報**: Web検索結果、トレンド分析、感情分析
- **参加エージェント詳細**: 各エージェントの特性、専門分野、議論スタイル
- **ラウンド別会話**: 各エージェントの発言、意見タイプ、信頼度、根拠
- **協調分析結果**: 対立レベル、合意度、合意点・不一致点
- **最終結論**: 議論の結果と推奨事項

#### 🎨 デザイン特徴
- **カラフルなエージェントカード**: 各エージェントを視覚的に区別
- **意見タイプの絵文字表示**: 💚賛成, ✅同意, 🤝中立, ⚠️反対, ❌強く反対
- **エキスパンダーによる整理**: 情報を階層的に表示
- **メトリクス表示**: 重要な数値を目立つように表示

### 📄 **GUI内HTML報告書表示**

StreamlitのGUI内で直接HTML報告書を閲覧できる機能です。

#### ✨ 機能
- **インライン表示**: ブラウザ内でHTML報告書をそのまま表示
- **スクロール可能**: 大きな報告書も快適に閲覧
- **フル機能**: Chart.jsグラフやインタラクティブ要素もそのまま動作
- **ワンクリック生成**: ボタンを押すだけで生成・表示

#### 🔧 技術仕様
- `st.components.v1.html()` を使用してHTMLを埋め込み
- 高さ800px、スクロール機能付き
- UTF-8エンコーディング対応

### 📊 **統合セッションビューア**

3つのタブで情報を整理して表示する統合ビューアです。

#### 📑 タブ構成
1. **💬 会話詳細**: 全会話内容の詳細表示
2. **📊 分析結果**: グラフとメトリクスによる分析
3. **📄 HTML報告書**: 美しいHTML報告書の表示

## 🚀 使用方法

### 1. **新しい議論完了後**

議論が完了すると、以下の3つのボタンが表示されます：

```
[💬 会話詳細を見る]  [📄 HTML報告書を表示]  [💾 HTML報告書を生成]
```

- **💬 会話詳細を見る**: 全会話内容を詳細表示
- **📄 HTML報告書を表示**: GUI内でHTML報告書を表示
- **💾 HTML報告書を生成**: HTMLファイルをローカルに保存

### 2. **過去の議論を分析**

セッションを選択後、以下のボタンが表示されます：

```
[📊 詳細分析を見る]  [📄 HTML報告書を表示]
```

### 3. **セッション一覧**

各セッションに以下のボタンが表示されます：

```
[💬 会話詳細]
[📊 分析結果]  
[📄 HTML報告書]
```

## 🎯 表示される情報

### 💬 会話詳細タブ

#### セッション情報
- 📋 基本情報（トピック、ID、日時、ラウンド数）
- 🔍 背景情報（関連記事数、トレンドスコア、感情分析）

#### エージェント情報
```
🎭 テックエバンジェリスト (technology)
├── 役割: technology_expert
├── 特性: 革新的で楽観的、技術の可能性を追求
├── 議論スタイル: データ駆動、実例重視、未来志向
├── 専門分野: • AI/ML • 最新技術動向
└── 相互作用: • 具体的な数値を要求 • 実例重視
```

#### ラウンド別会話
```
📞 ラウンド 1
├── 実施時刻: 14:23:45
└── エージェント発言
    ├── 🎭 テックエバンジェリスト [technology]
    │   ├── 発言内容: [実際の発言テキスト]
    │   ├── 意見: ✅ agree
    │   ├── 信頼度: 0.85
    │   └── 根拠: 研究データ, 市場調査
    └── 🤝 協調分析結果
        ├── 対立レベル: mild
        ├── 合意度: 0.65
        ├── 合意点: ✅ AI技術の重要性
        └── 不一致点: ❗ 実装タイミング
```

### 📊 分析結果タブ

- **📈 合意度推移チャート**: Plotlyによるインタラクティブグラフ
- **🎭 エージェント性能比較**: 平均信頼度 vs 影響力スコア
- **📊 詳細データ表**: pandas DataFrameによる表形式表示

### 📄 HTML報告書タブ

- **フル機能HTML**: Chart.jsグラフ、CSS、JavaScript完全対応
- **スクロール表示**: 長いレポートも快適に閲覧
- **レスポンシブ**: デスクトップ・タブレットに対応

## 🔧 技術実装

### 使用技術
- **Streamlit Components**: HTML埋め込み
- **Custom CSS**: 美しいエージェントカード
- **Session State**: 画面間の状態管理
- **Plotly**: インタラクティブグラフ
- **Pandas**: データ表示

### ファイル構造
```
streamlit_app.py
├── display_conversation_details()    # 会話詳細表示
├── display_html_report_in_streamlit() # HTML埋め込み表示
├── show_session_viewer()             # 統合ビューア
└── main()                           # メインアプリケーション
```

## 📱 ユーザー体験

### Before（改良前）
- HTML報告書は別ファイル生成のみ
- 会話内容は分析結果でのみ確認可能
- セッション切り替えが煩雑

### After（改良後）
- ✅ GUI内でHTML報告書を直接表示
- ✅ 全会話内容を美しく詳細表示
- ✅ タブでの整理された情報表示
- ✅ ワンクリックでの画面切り替え
- ✅ 視覚的に分かりやすいエージェント表示

## 🎉 利点

1. **👁️ 視認性向上**: カラフルなエージェントカードと絵文字
2. **🚀 利便性向上**: GUI内完結、外部ファイル不要
3. **📊 情報整理**: タブによる情報の階層化
4. **💻 使いやすさ**: ワンクリック操作
5. **🎨 美しさ**: プロフェッショナルなデザイン

これで、StreamlitGUIが完全に機能豊富なアプリケーションになりました！